function JSDragDropTree(){this.foldercloseImage="/img/folder_close.gif",this.folderopenImage="/img/folder_open.gif",this.plusImage="/img/node_plus.gif",this.minusImage="/img/node_minus.gif",this.q={department:"department=&Vendor=&OS=&CPU=&RAM=&group=department&group=&group=&company=",displayName:"Vendor=&OS=&CPU=&RAM=&group=displayName&group=&group=&department=",pcinfo:"company=&Vendor=&OS=&CPU=&RAM=&group=displayName&group=ComputerName&group=Model&group=SN&displayName="}}JSDragDropTree.prototype={getList:function(e,t,n,i){$.ajax({type:"post",url:"/statistics/",data:e,async:!1,success:function(e){if(e){var r=e.map(function(e){return e._id[n]});i(t,r,n)}}})},createSubUl:function(e,t,n){var i=(document.getElementById("parentNode"),document.createElement("UL")),r=parseInt(e.className.split("_").pop());i.className="ul_"+r,i.style.display="block",$.each(t,function(t,o){var a=document.createElement("LI");if(a.className="li_"+(r+1),"department"===n){var s=document.createElement("IMG"),c=document.createElement("IMG");s.src="/img/node_plus.gif",c.src="/img/folder_close.gif"}else if("displayName"===n){var c=document.createElement("IMG");c.src="/img/head.png"}var l=document.createElement("a");l.href="javascript:void(0)",l.innerText=o,s&&a.appendChild(s),a.appendChild(c),a.appendChild(l),i.appendChild(a),e.appendChild(i)})},showInfo:function(e,t){$.post("/statistics/",e,function(e){t.html(""),e.forEach(function(e){Object.keys(e._id).forEach(function(n){t.append("<tr><th>"+n+"</th><td>"+e._id[n]+"</td></tr>")})})})}},$(function(){function e(e,t){"block"===$(e).next()[0].style.display?$(e).prev().attr("src",t.folderopenImage).prev().attr("src",t.minusImage):$(e).prev().attr("src",t.foldercloseImage).prev().attr("src",t.plusImage)}function t(t,n){t.prev().prev().on("click",function(){$(t).nextAll().toggle(),e(t,n)})}treeObj=new JSDragDropTree;var n=$("#top_node");n.on("click",function(){$(n).nextAll().toggle(),e(n,treeObj)}),t(n,treeObj),$(".li_2").on("click",function(){treeObj.getList(treeObj.q.department+$(this).text(),this,"department",treeObj.createSubUl),$(this).find("img").first().attr("src",treeObj.minusImage).next().attr("src",treeObj.folderopenImage),$(this).unbind();var n=$(this).find("a:first");n.on("click",function(){$(this).nextAll().toggle(),e(this,treeObj)}),t(n,treeObj),$(this).find(".li_3").on("click",function(){treeObj.getList(treeObj.q.displayName+$(this).text()+"&company="+n.text(),this,"displayName",treeObj.createSubUl),$(this).find("img").first().attr("src",treeObj.minusImage).next().attr("src",treeObj.folderopenImage),$(this).unbind();var i=$(this).find("a:first");i.on("click",function(){$(this).nextAll().toggle(),e(this,treeObj)}),t(i,treeObj),$(this).find(".li_4").on("click",function(){treeObj.showInfo(treeObj.q.pcinfo+$(this).text(),$("#pcinfo-list"))})})})});